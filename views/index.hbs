<!--Citation for index.hbs:
Date: 05/17/2024
Copied steps 4 and 5 from nodejs-starter-app
Authors (github username): gkochera, Cortona1, currym-osu, dmgs11
Source URL: https://github.com/osu-cs340-ecampus/nodejs-starter-app/tree/main
-->

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

{{!-- the checkouts entity acts as our index page --}}

<!-- display Checkouts using a table-->
<h2>Checkouts</h2>
{{!-- Create a table --}}
<table id = "checkouts-table">

    {{!-- Header section --}}
    <thead>

        {{!-- For just the first row, we print each key of the row object as a header cell so we
        know what each column means when the page renders --}}
        <tr>
            {{#each data.[0]}}
            <th>
                {{@key}}
            </th>
            {{/each}}
            <th>Delete</th>
        </tr>
    </thead>

    {{!-- Body section --}}
    <tbody>

        {{!-- For each row, print the checkoutID, member, employee, dateCheckedOut and dateDue in order --}}
        {{#each data}}
        <tr>
            <td>{{this.checkoutID}}</td>
            <td>{{this.member}}</td>
            <td>{{this.employee}}</td>
            <td>{{moment this.dateCheckedOut format="MM-DD-YYYY"}}</td>
            <td>{{moment this.dateDue format="MM-DD-YYYY"}}</td>
            <td><button onclick="deleteCheckout({{this.checkoutID}})">Delete</button></td>
        </tr>
        {{/each}}
    </tbody>
</table>
<script src="./js/delete_checkout.js"></script>


{{!--display all checked out books using a table --}}
<h2>Checked Out Books</h2>
<table>

    {{!-- Header section --}}
    <thead>

        {{!-- For just the first row, we print each key of the row object as a header cell so we
        know what each column means when the page renders --}}
        <tr>
            {{#each checkedOutBooks.[0]}}
            <th>
                {{@key}}
            </th>
            {{/each}}
        </tr>
    </thead>

    {{!-- Body section --}}
    <tbody>

        {{!-- For each row, print the checkoutID, bookTitle, and dateReturned in order --}}
        {{#each checkedOutBooks}}
        <tr>
            <td>{{this.checkoutID}}</td>
            <td>{{this.bookTitle}}</td>
            <td>{{moment this.dateReturned format = "MM-DD-YYYY"}}</td>
        </tr>
        {{/each}}
    </tbody>
</table>




<!-- INSERT a new Checkout using an HTML form with POST 
Gather member and employee with input from dropdown fields 
Gather dateCheckedOut and dateDue as date input-->
<h2>Add a new Checkout</h2>
<p>To add a new checkout, please enter its information below and click `Submit`!</p>
<form id="add-checkout-form" method="POST" action="/add-checkout-form">
    <label for="input-member">Member: </label>
    <select name="input-member" id="input-member-ajax">
        <option value="">Select a Member</option>
        {{#each members}}
        <option value="{{this.memberID}}">{{this.member}}</option>
        {{/each}}
    </select>
    
    <label for="input-employee">Employee: </label>
    <select name="input-employee" id="input-employee-ajax">
        <option value="">Select an Employee</option>
        {{#each employees}}
        <option value="{{this.employeeID}}">{{this.employee}}</option>
        {{/each}}
        <option value="null">No employee (self-checkout)</option>
    </select>

    <label for="input-dateCheckedOut">Date checked out: </label>
    <input type="date" name="input-dateCheckedOut" id="input-dateCheckedOut">

    <label for="input-dateDue">Date due: </label>
    <input type="date" name="input-dateDue" id="input-dateDue">
    
    <p></p>
    <input type="submit">
</form>

<!-- UPDATE a Checkout -->
<h2>Updating A Checkout</h2>
<p>To update a checkout, please fill in the below fields and click 'Submit'!</p>
<form id="update-checkout-form-ajax">

    <label for="input-checkoutID">Checkout: </label>
    <select name="input-checkoutID" id="mySelect">
        <option value="test">Select an Checkout</option>
        {{#each data}}
        <option value="{{this.checkoutID}}">{{this.checkoutID}}</option>
        {{/each}}
    </select>

    <label for="input-member">Member: </label>
    <select name="input-member" id="input-member-update">
        <option>Select a Member</option>
        {{#each members}}
        <option value="{{this.memberID}}">{{this.member}}</option>
        {{/each}}
    </select>

    <label for='input-employee'>Employee: </label>
    <select name="input-employee" id="input-employee-update">
        <option>Select an Employee</option>
        {{#each employees}}
        <option value="{{this.employeeID}}">{{this.employee}}</option>
        {{/each}}
    </select>

    <label for="input-dateCheckedOut">Date checked out: </label>
    <input type="date" name="input-dateCheckedOut" id="input-dateCheckedOut-update">

    <label for="input-dateDue">Date due: </label>
    <input type="date" name="input-dateDue" id="input-dateDue-update">
    
    <p></p>
    <input type="submit">

</form>

<script src="./js/update_checkout.js"></script>
